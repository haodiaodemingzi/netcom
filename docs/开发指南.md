# 漫画阅读器开发指南

## 项目概述

这是一个基于 React Native + Expo 和 Flask 开发的全平台漫画阅读应用。

## 技术栈

### 前端
- **框架**: React Native + Expo
- **路由**: Expo Router
- **UI**: React Native Paper
- **状态管理**: React Hooks + Context
- **网络请求**: Axios
- **本地存储**: AsyncStorage
- **手势处理**: React Native Gesture Handler
- **动画**: React Native Reanimated

### 后端
- **框架**: Flask
- **数据采集**: BeautifulSoup
- **缓存**: 内存缓存 (可升级为 Redis)

## 项目结构

```
comic-reader/
├── app/                    # 页面路由
│   ├── (tabs)/            # 底部导航页面
│   │   ├── index.js       # 首页
│   │   ├── search.js      # 搜索
│   │   ├── favorite.js    # 收藏
│   │   └── profile.js     # 个人中心
│   ├── comic/[id].js      # 漫画详情
│   ├── reader/[chapterId].js  # 阅读器
│   └── history.js         # 历史记录
├── components/            # 可复用组件
│   ├── ComicCard.js      # 漫画卡片
│   ├── ChapterList.js    # 章节列表
│   ├── ImageViewer.js    # 图片查看器
│   └── ReaderToolbar.js  # 阅读工具栏
├── services/             # 服务层
│   ├── api.js           # API 接口
│   └── storage.js       # 本地存储
├── utils/               # 工具函数
│   └── constants.js     # 常量定义
├── backend/             # 后端服务
│   ├── app.py          # Flask 应用
│   ├── routes/         # 路由
│   └── services/       # 服务
└── assets/             # 静态资源
```

## 快速开始

### 1. 安装前端依赖

```bash
npm install
```

### 2. 安装后端依赖

```bash
cd backend
pip install -r requirements.txt
```

### 3. 启动开发服务器

**方式一: 使用启动脚本 (Windows)**
```bash
start.bat
```

**方式二: 手动启动**

终端 1 - 启动前端:
```bash
npm start
```

终端 2 - 启动后端:
```bash
cd backend
python app.py
```

## 核心功能实现

### 1. 首页漫画列表

文件: `app/(tabs)/index.js`

功能:
- 分类筛选 (热门/最新/完结/连载)
- 下拉刷新
- 上拉加载更多
- 卡片式布局

### 2. 搜索功能

文件: `app/(tabs)/search.js`

功能:
- 关键词搜索
- 搜索历史
- 搜索结果展示

### 3. 漫画详情

文件: `app/comic/[id].js`

功能:
- 漫画信息展示
- 收藏/取消收藏
- 章节列表
- 开始阅读

### 4. 阅读器

文件: `app/reader/[chapterId].js`

功能:
- 横向翻页
- 图片缩放
- 进度条
- 章节切换
- 阅读设置

### 5. 收藏和历史

文件: `app/(tabs)/favorite.js`, `app/history.js`

功能:
- 收藏管理
- 历史记录
- 阅读进度

## 数据流

1. **API 请求**: `services/api.js` → 后端 API
2. **数据缓存**: 后端缓存 + 前端 AsyncStorage
3. **状态管理**: React Hooks (useState, useEffect)
4. **本地存储**: `services/storage.js`

## 开发建议

### 代码规范

1. **文件命名**: 使用小驼峰或中划线
2. **组件命名**: 使用大驼峰 (PascalCase)
3. **函数命名**: 使用小驼峰 (camelCase)
4. **常量命名**: 使用大写下划线 (UPPER_SNAKE_CASE)
5. **代码长度**: 每行不超过 120 字符

### 性能优化

1. **图片优化**
   - 使用 Fast Image 缓存
   - 实现图片预加载
   - 懒加载可见区域

2. **列表优化**
   - 使用 FlatList 虚拟列表
   - 设置 keyExtractor
   - 优化 renderItem

3. **缓存策略**
   - API 响应缓存
   - 图片磁盘缓存
   - 本地数据缓存

### 调试技巧

1. **React Native Debugger**
2. **Console.log**
3. **Expo DevTools**
4. **Network 监控**

## 后续优化

### 功能扩展

- [ ] 离线下载
- [ ] 书签功能
- [ ] 评论系统
- [ ] 推荐算法
- [ ] 云同步

### 性能优化

- [ ] Redis 缓存
- [ ] CDN 加速
- [ ] 图片压缩
- [ ] 代码分割

### 用户体验

- [ ] 骨架屏
- [ ] 加载动画
- [ ] 错误处理
- [ ] 空状态设计

## 常见问题

### Q: 如何修改 API 地址?

A: 修改 `utils/constants.js` 中的 `API_BASE_URL`

### Q: 如何添加新的漫画源?

A: 在 `backend/services/scraper.py` 中实现新的爬虫类

### Q: 如何自定义主题?

A: 修改 `utils/constants.js` 中的 `COLORS` 配置

## 部署指南

### 前端部署

1. **Web**: `npx expo export:web`
2. **Android**: `eas build --platform android`
3. **iOS**: `eas build --platform ios`

### 后端部署

1. 使用 Gunicorn + Nginx
2. 配置 HTTPS
3. 启用 Redis 缓存
4. 设置进程守护

## 许可证

MIT License
